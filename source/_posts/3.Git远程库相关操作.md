---
title: Git.3.远程库相关操作
date: 2019-02-17 15:03:32
tags: 
  - Git
categories: 
	- 版本控制工具
---

## Git远程与GitHub
push 推送
pull 拉取
pull == fetch + merge


## git push 的两种方式
git config --global push.default simple

## 使用SSH密钥与GitHub仓库关联（推荐）
```
git remote add origin git@github.com:dgqg1223/dgqg1223.github.io.git
git remote show origin
which ssh-keygen    #需要ssh环境
shh-keygen          #需要ssh环境
ssh-keygen -t rsa -C "邮件地址@youremail.com"  #windows下
~/.shh/id_ras #私钥文件 
~/.shh/id_rsa.put #公钥文件 
在github仓库界面 选择Settings下的Deploy keys >> Add depoloy key 添加id_ras中生成的私钥 >> 勾选Allow write access(push权限) >> Add key
git push -u origin master 
```

## 使用https与GitHub仓库关联（传输不加密，每次需要输入用户名密码）
git remote add origin https://github.com/dgqg1223/dgqg1223.github.io.git
git remote show origin
git push -u origin master

git remote show 列出所有与此项目关联的远程仓库
git remote show \<origin> 列出远程仓库的详细信息
git push

## git管理模型
1. Gitflow 参考
2. 基于Git分支的开发模型
    develop分支 开发人员写作开发使用 （频繁变化的一个分支）
    test分支 供测试与产品等人员使用的一个分支（变化不是特别频繁）
    master分支 生产发布分支（变化非常不频繁的分支）
    bugfix或hotfix 分支 生产当中出现了紧急的BUG，用于紧急修复分支
 

## git协作
git原理 实际会建立个 origin/master 远程分支来对应远程版本库中的 master分支， origin/master 会追踪远程版本库中的 master分支，指向最新的ciommit。
查看远程分支 origin/master
```
$ git branch -a
* master
  remotes/origin/master
$ git branch -av    #显示远程分支和最近一次commit id。
```

模拟练习2个人操作远程版本库 


远程仓库克隆到本地
git clone \<ssh or https git path> [new branch name]


gitk与git gui 
在git仓库下 敲入gitk 调出界面


使用stack overflow 搜索问题
使用云梯vpn
monaco字体

git 合并原则 三方合并原则

## git 别名
git config --goloba alias.br branch   #定义别名 br 实际定义到.gitconfig 文件中了
git br  等同于 git bran ch
git config --goloba alias.ui '!gitk'  #当定义的是外部命令时，要在命令前加 ! 

## Git refspec
远程分支镜像和远程分支操作 
推送新建的分支 当远程没有这个分支时候使用git put会报错，需要使用下面命令  
方法一（推荐，可对应不同分支名  ）：  
git push --set-upstream origin srcBranch  
git push --set-upstream origin srcBranch:destBrabcg

方法二：
git push -u origin srcBranch  

当我门执行 git pull 时候当本地没有远程存在的分支时 我们需要新建分支并建立和远程分支的对应关系  
方法一（可对应不同分支名）：  
git checkout -b srcBranch destBrabcg  
方法二：  
git checkout --track destBrabcg



解决新建分支后 push 报错的情况
git push orgin HEAD:destBrabcg 
git push origin srcBranch:destBrabcg


删除远程分支
方法一：利用空分支推送到远程分支上
git push origin :srcBranch
方法二：
git push origin --delete srcBranch

重命名远程分支思路
先删除要重命名的远程分支 重命名本地分支 之后推送到远程 


## Git refspec 与远程标签
### refspec
refspec 指本地标签和远程标签映射关系
git push、git pull的完整命令 
git push origin srcBranch:destBrabcg
git pull origin srcBranch:destBrabcg

commit ：当我门执行commit时候git会为我们创建一个commit对象，会将这个commit对象的parent值(指针) 设置为之前HEAD引用所指向的SHA-1值 
git reflog 会记录所有对于的HEAD记录

cat git.HEAD

实际上我们可以通过底层命令 symbolic-ref 来实现对HEAD文件内容的修改(不会记录到reflog)

git symbolic-ref HEAD
git symbolic-ref HEAD refs/heads/master

.git/HEAD ：HEAD标记文件是一个指向你当前所在分支的引用标识符，该文件内部并不包含SHA-1值，包含的是指向另外一个引用的指针
.git/ORIG_HEAD : 存储远程最新commit id
.git/FETCH_head : 本地从远程pull时候会记录commit id 和message
.git/config : 存储远程分支和本地分支相关对应信息
.git/refs/
.git/refs/heads : 本地分支目录，每个分支文件中存放着该分支指向的提交点
.git/refs/remotes ： 远程分支目录，每个分支文件中存放着该分支指向的提交点
.git/refs/tag : 存放标签目录
.git/padked-refs ： 执行 git gc 后会将压缩后的标签移动到这个目录
.git/objects : 存放压缩后的项目文件


### 远程标签
标签 分为轻量级标签和带有注释的标签，下面v1.0 会生成指针 ，带有注释的标签会创建tag对象 在tag对象中指向所对应commitID

```
git tag v1.0
git tag -a v2.0 -m 'v2.0 released'
git show v1.0
git show v2.0 
tig lag -l '?2*'
git push origin v1.0
git push origin --tags

git pull 
git push origin :refs/tags/v1.0
git push origin --delete tag v5.0

git pull 
git tag v3.0
git push origin refs/tags/v3.0:refs/tags/v3.0
git fetch origin tag v3.0
```


### 远程分支删除本地分支如何同步
```
git remote show origin
git remote prune origin
```
 
### 查看远程分支log记录
在缺省情况下，refspec会被git remote add 命令所自动生成，Git会获取远程库上.get/refs/heads下所有的引用文件，并写入到本地库.get/refs/remotes/origin/ ，所以如果远端上有一个master分支，在本地就可以通过下面几种方式来访问他门的历史记录。（该操作文件可以在.git/config中查看）

git log origin/master #查看远程分支log记录  
git log remotes/origin/master  
git log refs/remotes/origin/master  


### .get/config 观察练习
```
git fetch origin master：refs/remotes/origin/mymaster
git branch 
git branch -av
git remote show origin #可以看到mymaster没有对应关系
git checkout --track origin/mymaster #手动创建对应关系
git remote show origin #仍然提示没有追踪，因为.git/config 没有相应对应关系，命令行只是一次执行
git remote prune origin 删除origin/mymaster
git branch 
git branch -av
git branch --unset-upstream 
git branch -d mymaster
git branch 
git branch -av
```

## Git gc

>git gc


执行该命令后会将refs中的文件打包 移动到 .git/padked-refs  